      <h1>
Box-Cox Transformations for Linear Models 
</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><span class="functioncall"><a href='boxCox.html'>boxCox</a></span><span class="keyword">(</span><span class="symbol">object</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span>

<span class="functioncall"><a href='boxCox.html'>boxCox</a></span><span class="keyword">(</span><span class="symbol">object</span><span class="keyword">,</span> <span class="argument">lambda</span> <span class="argument">=</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/seq'>seq</a></span><span class="keyword">(</span><span class="keyword">-</span><span class="number">2</span><span class="keyword">,</span> <span class="number">2</span><span class="keyword">,</span> <span class="number">1</span><span class="keyword">/</span><span class="number">10</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">plotit</span> <span class="argument">=</span> <span class="number">TRUE</span><span class="keyword">,</span> <span class="argument">interp</span> <span class="argument">=</span> <span class="keyword">(</span><span class="symbol">plotit</span> <span class="keyword">&amp;&amp;</span> <span class="keyword">(</span><span class="symbol">m</span> <span class="keyword">&lt;</span>
  <span class="number">100</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">eps</span> <span class="argument">=</span> <span class="number">1</span><span class="keyword">/</span><span class="number">50</span><span class="keyword">,</span> <span class="argument">xlab</span> <span class="argument">=</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/expression'>expression</a></span><span class="keyword">(</span><span class="symbol">lambda</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">ylab</span> <span class="argument">=</span> <span class="string">"log-Likelihood"</span><span class="keyword">,</span> <span class="argument">family</span> <span class="argument">=</span> <span class="string">"bcPower"</span><span class="keyword">,</span>
      <span class="argument">grid</span> <span class="argument">=</span> <span class="number">TRUE</span><span class="keyword">,</span> <span class="symbol">...</span><span class="keyword">)</span>

<span class="functioncall"><a href='boxCox.html'>boxCox</a></span><span class="keyword">(</span><span class="symbol">object</span><span class="keyword">,</span> <span class="argument">lambda</span> <span class="argument">=</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/seq'>seq</a></span><span class="keyword">(</span><span class="keyword">-</span><span class="number">2</span><span class="keyword">,</span> <span class="number">2</span><span class="keyword">,</span> <span class="number">1</span><span class="keyword">/</span><span class="number">10</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">plotit</span> <span class="argument">=</span> <span class="number">TRUE</span><span class="keyword">,</span> <span class="argument">interp</span> <span class="argument">=</span> <span class="keyword">(</span><span class="symbol">plotit</span> <span class="keyword">&amp;&amp;</span> <span class="keyword">(</span><span class="symbol">m</span> <span class="keyword">&lt;</span>
      <span class="number">100</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">eps</span> <span class="argument">=</span> <span class="number">1</span><span class="keyword">/</span><span class="number">50</span><span class="keyword">,</span> <span class="argument">xlab</span> <span class="argument">=</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/expression'>expression</a></span><span class="keyword">(</span><span class="symbol">lambda</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">ylab</span> <span class="argument">=</span> <span class="string">"log-Likelihood"</span><span class="keyword">,</span> <span class="argument">family</span> <span class="argument">=</span> <span class="string">"bcPower"</span><span class="keyword">,</span>
      <span class="symbol">...</span><span class="keyword">)</span>

<span class="functioncall"><a href='boxCox.html'>boxCox</a></span><span class="keyword">(</span><span class="symbol">object</span><span class="keyword">,</span> <span class="argument">lambda</span> <span class="argument">=</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/seq'>seq</a></span><span class="keyword">(</span><span class="keyword">-</span><span class="number">2</span><span class="keyword">,</span> <span class="number">2</span><span class="keyword">,</span> <span class="number">1</span><span class="keyword">/</span><span class="number">10</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">plotit</span> <span class="argument">=</span> <span class="number">TRUE</span><span class="keyword">,</span> <span class="argument">interp</span> <span class="argument">=</span> <span class="keyword">(</span><span class="symbol">plotit</span> <span class="keyword">&amp;&amp;</span> <span class="keyword">(</span><span class="symbol">m</span> <span class="keyword">&lt;</span>
      <span class="number">100</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">eps</span> <span class="argument">=</span> <span class="number">1</span><span class="keyword">/</span><span class="number">50</span><span class="keyword">,</span> <span class="argument">xlab</span> <span class="argument">=</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/expression'>expression</a></span><span class="keyword">(</span><span class="symbol">lambda</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">ylab</span> <span class="argument">=</span> <span class="string">"log-Likelihood"</span><span class="keyword">,</span> <span class="argument">family</span> <span class="argument">=</span> <span class="string">"bcPower"</span><span class="keyword">,</span>
      <span class="symbol">...</span><span class="keyword">)</span></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>object</dt>
      <dd>
a formula or fitted model object. Currently only <code>lm</code> and <code>aov</code> objects are handled.
</dd>
      <dt>lambda</dt>
      <dd>
vector of values of lambda, with default (-2, 2) in steps of 0.1, where the profile
log-likelihood will be evaluated. 
</dd>
      <dt>plotit</dt>
      <dd>
logical which controls whether the result should be plotted; default <code>TRUE</code>. 
</dd>
      <dt>interp</dt>
      <dd>
logical which controls whether spline interpolation is used. Default to 
<code>TRUE</code> if plotting with lambda of length less than 100.
</dd>
      <dt>eps</dt>
      <dd>
Tolerance for lambda = 0; defaults to 0.02.
</dd>
      <dt>xlab</dt>
      <dd>
defaults to <code>"lambda"</code>.
</dd>
      <dt>ylab</dt>
      <dd>
defaults to <code>"log-Likelihood"</code>. 
</dd>
      <dt>family</dt>
      <dd>
Defaults to <code>"bcPower"</code> for the Box-Cox power family of
transformations.  If set to <code>"yjPower"</code> the Yeo-Johnson family, which
permits negative responses, is used.
</dd>
      <dt>grid</dt>
      <dd>If TRUE, the default, a light-gray background grid is put on the
graph.
</dd>
      <dt>...</dt>
      <dd>
additional parameters to be used in the model fitting.
</dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>
      
      <p>Computes and optionally plots profile log-likelihoods for the parameter of the 
Box-Cox power transformation.   This is a slight generalization of the
<code>boxcox</code> function in the <span class = "pkg">MASS</span> package that allows for families of transformations
other than the Box-Cox power family.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>
      
      <p>This routine is an elaboration of the <code><a href='http://www.inside-r.org/r-doc/MASS/boxcox'>boxcox</a></code> function in the
<span class = "pkg">MASS</span> package.  All arguments except for <code>family</code> and <code>grid</code> are 
identical, and if the arguments 
<code>family = "bcPower", grid=FALSE</code> is set it gives an identical graph.  If 
<code>family = "yjPower"</code> then the Yeo-Johnson power transformations, which
allow nonpositive responses, will be used.</p>
  
    </div>

    <div class="Value">
      <h2>Value</h2>
      
      <p>A list of the lambda vector and the computed profile log-likelihood vector, 
invisibly if the result is plotted.  If <code>plotit=TRUE</code> plots log-likelihood vs 
lambda and indicates a 95
lambda. If <code>interp=TRUE</code>, spline interpolation is used to give a smoother plot.</p>
  
      <p></p>
  
    </div>

    <div class="References">
      <h2>References</h2>
      
      <p></p>
  
      <p>Box, G. E. P. and Cox, D. R. (1964) An analysis of transformations.
<em>Journal
of the Royal Statisistical Society, Series B</em>. 26 211-46.</p>
  
      <p>Cook, R. D. and Weisberg, S. (1999)  <em>Applied Regression Including
Computing
and Graphics</em>.  Wiley.</p>
  
      <p>Fox, J. (2008)
<em>Applied Regression Analysis and Generalized Linear Models</em>,
Second Edition. Sage.</p>
  
      <p>Fox, J. and Weisberg, S. (2011) 
<em>An R Companion to Applied Regression</em>, Second Edition, Sage.</p>
  
      <p>Weisberg, S. (2005) <em>Applied Linear Regression</em>, Third Edition. Wiley.</p>
  
      <p>Yeo, I. and Johnson, R. (2000)  A new family of
power transformations to improve normality or symmetry.  
<em>Biometrika</em>, 87, 954-959.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'><span class="functioncall"><a href='boxCox.html'>boxCox</a></span><span class="keyword">(</span><span class="symbol">Volume</span> <span class="keyword">~</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/Log'>log</a></span><span class="keyword">(</span><span class="symbol">Height</span><span class="keyword">)</span> <span class="keyword">+</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/Log'>log</a></span><span class="keyword">(</span><span class="symbol">Girth</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">data</span> <span class="argument">=</span> <span class="symbol">trees</span><span class="keyword">,</span>
       <span class="argument">lambda</span> <span class="argument">=</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/seq'>seq</a></span><span class="keyword">(</span><span class="keyword">-</span><span class="number">0.25</span><span class="keyword">,</span> <span class="number">0.25</span><span class="keyword">,</span> <span class="argument">length</span> <span class="argument">=</span> <span class="number">10</span><span class="keyword">)</span><span class="keyword">)</span></div>
<p><img src='boxCox-2.png' alt='' width='400' height='400' /></p>
<div class='input'>
<span class="functioncall"><a href='boxCox.html'>boxCox</a></span><span class="keyword">(</span><span class="symbol">Days</span> <span class="keyword">~</span> <span class="symbol">Eth</span><span class="keyword">*</span><span class="symbol">Sex</span><span class="keyword">*</span><span class="symbol">Age</span><span class="keyword">*</span><span class="symbol">Lrn</span><span class="keyword">,</span> <span class="argument">data</span> <span class="argument">=</span> <span class="symbol">quine</span><span class="keyword">,</span>
       <span class="argument">lambda</span> <span class="argument">=</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/seq'>seq</a></span><span class="keyword">(</span><span class="keyword">-</span><span class="number">0.05</span><span class="keyword">,</span> <span class="number">0.45</span><span class="keyword">,</span> <span class="argument">len</span> <span class="argument">=</span> <span class="number">20</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">family</span><span class="argument">=</span><span class="string">"yjPower"</span><span class="keyword">)</span></div>
<p><img src='boxCox-4.png' alt='' width='400' height='400' /></p></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>boxCox</li><li>boxCox.lm</li><li>boxCox.default</li><li>boxCox.formula</li>
    </ul>
    <ul>
      <li> regression</li>
    </ul> -->
      
    <h2>See also</h2>
    
<code><a href='http://www.inside-r.org/r-doc/MASS/boxcox'>boxcox</a></code>, <code><a href='bcPower.html'>yjPower</a></code>, <code><a href='bcPower.html'>bcPower</a></code>,
<code><a href='powerTransform.html'>powerTransform</a></code>

    
    <h2>Author</h2>
     Sanford Weisberg, <sandy@stat.umn.edu> 
    
  </div>
</div>