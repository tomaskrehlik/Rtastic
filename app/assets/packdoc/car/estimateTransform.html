      <h1>Finding Univariate or Multivariate Power Transformations</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><span class="functioncall"><a href='estimateTransform.html'>estimateTransform</a></span><span class="keyword">(</span><span class="symbol">X</span><span class="keyword">,</span> <span class="symbol">Y</span><span class="keyword">,</span> <span class="argument">weights</span> <span class="argument">=</span> NULL<span class="keyword">,</span> <span class="argument">family</span> <span class="argument">=</span> <span class="string">"bcPower"</span><span class="keyword">,</span> <span class="argument">start</span> <span class="argument">=</span> NULL<span class="keyword">,</span> <span class="argument">method</span> <span class="argument">=</span> <span class="string">"L-BFGS-B"</span><span class="keyword">,</span>
  <span class="symbol">...</span><span class="keyword">)</span></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>X</dt>
      <dd>A matrix or data.frame giving the &#147;right-side variables&#148;.</dd>
      <dt>Y</dt>
      <dd>A vector or matrix or data.frame giving the &#147;left-side
variables.&#148;</dd>
      <dt>weights</dt>
      <dd>Weights as in <code>lm</code>.</dd>
      <dt>family</dt>
      <dd>The transformation family to use.  This is the quoted name of a
  function for computing the transformed values.  The default is
<code>bcPower</code>
  for the Box-Cox power family and the most likely alternative is
  <code>yjPower</code> for the Yeo-Johnson family of transformations.</dd>
      <dt>start</dt>
      <dd>Starting values for the computations.  It is usually adequate
  to leave this at its default value of NULL.</dd>
      <dt>method</dt>
      <dd>The computing alogrithm used by <code><a href='http://www.inside-r.org/r-doc/stats/optim'>optim</a></code> for the
  maximization.  The default <code>"L-BFGS-B"</code> appears to work well.</dd>
      <dt>...</dt>
      <dd>Additional arguments that are passed to the <code><a href='http://www.inside-r.org/r-doc/stats/optim'>optim</a></code> 
  function that does the maximization.  Needed only if there are convergence problems.</dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>
      
      <p><code>estimateTransform</code> computes members of families of transformations
indexed by one
parameter, the Box-Cox power family, or the Yeo and Johnson (2000) family, or
the
basic power family, interpreting zero power as logarithmic. 
The family can be modified to have Jacobian one, or not, except for the basic
power family.  Most users will use the function <code><a href='powerTransform.html'>powerTransform</a></code>, which
is a front-end for this function.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>
      
      <p>See the documentation for the function <code><a href='powerTransform.html'>powerTransform</a></code>.</p>
  
    </div>

    <div class="Value">
      <h2>Value</h2>
      
      <p>An object of class <code>powerTransform</code> with components
valueThe value of the loglikelihood at the mle.
countsSee <code><a href='http://www.inside-r.org/r-doc/stats/optim'>optim</a></code>.
convergenceSee <code><a href='http://www.inside-r.org/r-doc/stats/optim'>optim</a></code>.
messageSee <code><a href='http://www.inside-r.org/r-doc/stats/optim'>optim</a></code>.
hessianThe hessian matrix.
startStarting values for the computations.
lambdaThe ml estimate
roundlamConvenient rounded values for the estimates.  These rounded
values will  often be the desirable transformations.
familyThe transformation family 
xqrQR decomposition of the predictor matrix.
yThe responses to be transformed
xThe predictors
weightsThe weights if weighted least squares.</p>
  
    </div>

    <div class="References">
      <h2>References</h2>
      
      <p>Box, G. E. P. and Cox, D. R. (1964) An analysis of transformations. <em>Journal
of the Royal Statisistical Society, Series B</em>. 26 211-46.</p>
  
      <p>Cook, R. D. and Weisberg, S. (1999)  <em>Applied Regression Including Computing
and Graphics</em>.  Wiley.</p>
  
      <p>Fox, J. and Weisberg, S. (2011) 
<em>An R Companion to Applied Regression</em>, Second Edition, Sage.</p>
  
      <p>Velilla, S. (1993)  A note on the multivariate Box-Cox transformation to 
normality.  <em>Statistics and Probability Letters</em>, 17, 259-263.</p>
  
      <p>Weisberg, S. (2005) <em>Applied Linear Regression</em>, Third Edition. Wiley.</p>
  
      <p>Yeo, I. and Johnson, R. (2000) A new family of
power transformations to improve normality or symmetry.  
<em>Biometrika</em>, 87, 954-959.</p>
  
    </div>

    <div class="Finding Univariate or Multivariate Power Transformations">
      <h2>Finding Univariate or Multivariate Power Transformations</h2>
      
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'><span class="functioncall"><a href='http://www.inside-r.org/r-doc/utils/data'>data</a></span><span class="keyword">(</span><span class="symbol">trees</span><span class="keyword">,</span><span class="argument">package</span><span class="argument">=</span><span class="string">"MASS"</span><span class="keyword">)</span></div>
<strong class='warning'>Warning message:
data set ‘trees’ not found</strong>
<div class='input'><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/summary'>summary</a></span><span class="keyword">(</span><span class="symbol">out1</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='powerTransform.html'>powerTransform</a></span><span class="keyword">(</span><span class="symbol">Volume</span><span class="keyword">~</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/Log'>log</a></span><span class="keyword">(</span><span class="symbol">Height</span><span class="keyword">)</span><span class="keyword">+</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/Log'>log</a></span><span class="keyword">(</span><span class="symbol">Girth</span><span class="keyword">)</span><span class="keyword">,</span><span class="symbol">trees</span><span class="keyword">)</span><span class="keyword">)</span></div>
<div class='output'>bcPower Transformation to Normality 

   Est.Power Std.Err. Wald Lower Bound Wald Upper Bound
Y1   -0.0673   0.0873          -0.2384           0.1037

Likelihood ratio tests about transformation parameters
                          LRT df      pval
LR test, lambda = (0)  0.5876  1 4.433e-01
LR test, lambda = (1) 58.7606  1 1.776e-14
</div>
<div class='input'><span class="comment"># multivariate transformation:</span>
<span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/summary'>summary</a></span><span class="keyword">(</span><span class="symbol">out2</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='powerTransform.html'>powerTransform</a></span><span class="keyword">(</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/cbind'>cbind</a></span><span class="keyword">(</span><span class="symbol">Volume</span><span class="keyword">,</span><span class="symbol">Height</span><span class="keyword">,</span><span class="symbol">Girth</span><span class="keyword">)</span><span class="keyword">~</span><span class="number">1</span><span class="keyword">,</span><span class="symbol">trees</span><span class="keyword">)</span><span class="keyword">)</span></div>
<div class='output'>bcPower Transformations to Multinormality 

       Est.Power Std.Err. Wald Lower Bound Wald Upper Bound
Volume   -0.1191   0.2235          -0.5572           0.3190
Height    1.4786   1.6896          -1.8331           4.7903
Girth    -0.1994   0.5560          -1.2892           0.8904

Likelihood ratio tests about transformation parameters
                              LRT df      pval
LR test, lambda = (0 0 0)  1.6026  3 6.588e-01
LR test, lambda = (1 1 1) 40.1428  3 9.938e-09
LR test, lambda = (0 1 0)  0.6136  3 8.933e-01
</div>
<div class='input'><span class="functioncall"><a href='testTransform.html'>testTransform</a></span><span class="keyword">(</span><span class="symbol">out2</span><span class="keyword">,</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/c'>c</a></span><span class="keyword">(</span><span class="number">0</span><span class="keyword">,</span><span class="number">1</span><span class="keyword">,</span><span class="number">0</span><span class="keyword">)</span><span class="keyword">)</span></div>
<div class='output'>                             LRT df   pval
LR test, lambda = (0 1 0) 0.6136  3 0.8933
</div>
<div class='input'><span class="comment"># same transformations, but use lm objects</span>
<span class="symbol">m1</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/lm'>lm</a></span><span class="keyword">(</span><span class="symbol">Volume</span><span class="keyword">~</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/Log'>log</a></span><span class="keyword">(</span><span class="symbol">Height</span><span class="keyword">)</span><span class="keyword">+</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/Log'>log</a></span><span class="keyword">(</span><span class="symbol">Girth</span><span class="keyword">)</span><span class="keyword">,</span><span class="symbol">trees</span><span class="keyword">)</span>
<span class="keyword">(</span><span class="symbol">out3</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='powerTransform.html'>powerTransform</a></span><span class="keyword">(</span><span class="symbol">m1</span><span class="keyword">)</span><span class="keyword">)</span></div>
<div class='output'>Estimated transformation parameters 
      Y1 
-0.06731 
</div>
<div class='input'><span class="comment"># update the lm model with the transformed response</span>
<span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/update'>update</a></span><span class="keyword">(</span><span class="symbol">m1</span><span class="keyword">,</span><span class="functioncall"><a href='bcPower.html'>basicPower</a></span><span class="keyword">(</span><span class="symbol">out3</span><span class="keyword">$</span><span class="symbol">y</span><span class="keyword">,</span><span class="symbol">out3</span><span class="keyword">$</span><span class="symbol">roundlam</span><span class="keyword">)</span><span class="keyword">~</span><span class="symbol">.</span><span class="keyword">)</span></div>
<div class='output'>
Call:
lm(formula = basicPower(out3$y, out3$roundlam) ~ log(Height) + 
    log(Girth), data = trees)

Coefficients:
(Intercept)  log(Height)   log(Girth)  
      -6.63         1.12         1.98  

</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>estimateTransform</li>
    </ul>
    <ul>
      <li> regression</li>
    </ul> -->
      
    <h2>See also</h2>
    <code><a href='powerTransform.html'>powerTransform</a></code>, <code><a href='testTransform.html'>testTransform</a></code>,
<code><a href='http://www.inside-r.org/r-doc/stats/optim'>optim</a></code>. 
    
    <h2>Author</h2>
     Sanford Weisberg, <sandy@stat.umn.edu> 
    
  </div>
</div>