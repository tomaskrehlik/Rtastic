      <h1>
Smoothers to Draw Lines on Scatterplots
</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><span class="functioncall"><a href='ScatterplotSmoothers.html'>gamLine</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">y</span><span class="keyword">,</span> <span class="symbol">col</span><span class="keyword">,</span> <span class="symbol">log.x</span><span class="keyword">,</span> <span class="symbol">log.y</span><span class="keyword">,</span> <span class="argument">spread</span> <span class="argument">=</span> <span class="number">FALSE</span><span class="keyword">,</span> <span class="symbol">smoother.args</span><span class="keyword">)</span>

<span class="functioncall"><a href='ScatterplotSmoothers.html'>loessLine</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">y</span><span class="keyword">,</span> <span class="symbol">col</span><span class="keyword">,</span> <span class="symbol">log.x</span><span class="keyword">,</span> <span class="symbol">log.y</span><span class="keyword">,</span> <span class="argument">spread</span> <span class="argument">=</span> <span class="number">FALSE</span><span class="keyword">,</span> <span class="symbol">smoother.args</span><span class="keyword">)</span>

<span class="functioncall"><a href='ScatterplotSmoothers.html'>quantregLine</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">y</span><span class="keyword">,</span> <span class="symbol">col</span><span class="keyword">,</span> <span class="symbol">log.x</span><span class="keyword">,</span> <span class="symbol">log.y</span><span class="keyword">,</span> <span class="argument">spread</span> <span class="argument">=</span> <span class="number">FALSE</span><span class="keyword">,</span> <span class="symbol">smoother.args</span><span class="keyword">)</span></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>x</dt>
      <dd>$x$ coordinates of points.</dd>
      <dt>y</dt>
      <dd>$y$ coordinates of points.</dd>
      <dt>col</dt>
      <dd>line color.</dd>
      <dt>log.x</dt>
      <dd><code>TRUE</code> if the $x$-axis is logged.</dd>
      <dt>log.y</dt>
      <dd><code>TRUE</code> if the $y$-axis is logged.</dd>
      <dt>spread</dt>
      <dd>the default is to plot only an estimated mean or median.  If this
  argument is TRUE, then a measure of spread is also plotted.</dd>
      <dt>smoother.args</dt>
      <dd>additional options accapted by the smoother, in the form of a list of
    named values (see <em>Details</em> below).</dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>
      
      <p>These smoothers are used to draw nonparametric-regression lines on scatterplots produced by
the <code><a href='scatterplot.html'>scatterplot</a></code>, <code><a href='scatterplotMatrix.html'>scatterplotMatrix</a></code> and other <code>car</code> functions. 
The functions aren't meant to
be called directly by the user, although the user can supply options via the <code>smoother.args</code> argument,
the contents of which vary by the smoother (see <em>Details</em> below). The <code>gamLine</code> smoother uses the
<code><a href='http://www.inside-r.org/r-doc/mgcv/gam'>gam</a></code> function in the <span class = "pkg">mgcv</span> package, the <code>loessLine</code> smoother uses the
<code><a href='http://www.inside-r.org/r-doc/stats/loess'>loess</a></code> function in the <span class = "pkg">stats</span> package, and the <code>quantregLine</code> smoother uses the
<code><a href='http://www.inside-r.org/r-doc/quantreg/rqss'>rqss</a></code> function in the <span class = "pkg">quantreg</span> package.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>
      
      <p>The function <code>loessLine</code> is a reimplementation of the <code>loess</code> smoother
that has been used in <code>car</code> prior to September 2012.  The only enhancement is the ability to
set more arguments through the <code>smoother.args</code> argument.</p>
  
      <p>The function <code>gamLine</code> is new and more general than the <code>loess</code> fitting
because it allows fitting a generalized additive model using splines.  You can specify a error
distribution and link function.</p>
  
      <p>The function <code>quantregLine</code> fits an additive model using splines with estimation
based on L1 regression and quantile regression if you ask for the spread.  It is
likely to be more robust than the other smoothers.</p>
  
      <p>The argument <code>smoother.args</code> is a list of named elements used to pass 
additional arguments to the smoother.</p>
  
      <p>For <code>loessLine</code> the default value is
<code>smoother.args=list(lty=1, lwd=2, lty.spread=2, lwd.spread=1, span=0.5,
degree=2, family="symmetric", iterations=4)</code>.  
The arguments <code>lty</code> and <code>lwd</code> are the type and width 
respectively of the mean or median smooth, <code>smooth.lty</code>
and <code>smooth.lwd</code> are the type and color of the spread smooths if requested.
The arguments <code>span</code>, <code>degree</code> and <code>family</code> are
passed to the <code><a href='http://www.inside-r.org/r-doc/stats/loess'>loess</a></code> function, <code>iterations=0</code> by default
specifies no robustness iterations.</p>
  
      <p>For <code>gamLine</code> the default is
<code>smoother.args=list(lty=1, lwd=2, lty.spread=2, lwd.spread=1,
k=-1, bs="tp", family="gaussian", link=NULL, weights=NULL)</code>
The first for arguments are as for <code>loessLine</code>.  The next two 
arguments are passed to the <code>gam</code> function to control the smoothing:
<code>k=-1</code> allows <code>gam</code> to choose the number of splines in the basis
function; <code>bs="tp"</code> provides the type of spline basis to be used with <code>"tp"</code> 
for the default thin-plate splines.  The last three arguments allow providing
a family, link and weights as in generalized linear models.  See examples
below.</p>
  
      <p>For <code>quantregLine</code> the default is
<code>smoother.args=list(lty=1, lwd=2, lty.spread=2, lwd.spread=1,
lambda=IQR(x)</code>.  The first four
arguments are as for <code>loessLine</code>.  The last argument is passed to the
<code><a href='http://www.inside-r.org/r-doc/quantreg/qss'>qss</a></code> function in <code>quantreg</code>.  It is a smoothing
parameter, here a robust estimate of the scale of the horizontal axis variable.
This is an arbitrary choice, and may not work well in all circumstances.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-2.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-3.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-4.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-5.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">gamLine</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-7.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-8.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-9.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-10.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-13.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">quantregLine</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-15.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-16.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-17.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-18.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-25.png' alt='' width='400' height='400' /></p>
<div class='input'>
<span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span> <span class="keyword">|</span> <span class="symbol">type</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-27.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-28.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span> <span class="keyword">|</span> <span class="symbol">type</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">gamLine</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-30.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-31.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-34.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span> <span class="keyword">|</span> <span class="symbol">type</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">quantregLine</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-36.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-37.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-40.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-43.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-46.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span> <span class="keyword">|</span> <span class="symbol">type</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span>NULL<span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-48.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-49.png' alt='' width='400' height='400' /></p>
<div class='input'>
<span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span> <span class="keyword">|</span> <span class="symbol">type</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">,</span> <span class="argument">spread</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-51.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-52.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span> <span class="keyword">|</span> <span class="symbol">type</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">gamLine</span><span class="keyword">,</span> <span class="argument">spread</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-54.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-55.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-60.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-63.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-68.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-71.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">prestige</span> <span class="keyword">~</span> <span class="symbol">income</span> <span class="keyword">|</span> <span class="symbol">type</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Prestige</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">quantregLine</span><span class="keyword">,</span> <span class="argument">spread</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-73.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-74.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-81.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-88.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-95.png' alt='' width='400' height='400' /></p>
<div class='input'>
<span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">weight</span> <span class="keyword">~</span> <span class="symbol">repwt</span> <span class="keyword">|</span> <span class="symbol">sex</span><span class="keyword">,</span> <span class="argument">spread</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Davis</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">loessLine</span><span class="keyword">)</span></div>
<p><img src='ScatterplotSmoothers-97.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-98.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">weight</span> <span class="keyword">~</span> <span class="symbol">repwt</span> <span class="keyword">|</span> <span class="symbol">sex</span><span class="keyword">,</span> <span class="argument">spread</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Davis</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">gamLine</span><span class="keyword">)</span> <span class="comment"># messes up</span></div>
<p><img src='ScatterplotSmoothers-100.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-101.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-104.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-109.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-112.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<strong class='warning'>Warning message:
matrix not positive definite</strong>
<p><img src='ScatterplotSmoothers-117.png' alt='' width='400' height='400' /></p>
<strong class='warning'>Warning message:
NaNs produced</strong>
<p><img src='ScatterplotSmoothers-119.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">weight</span> <span class="keyword">~</span> <span class="symbol">repwt</span> <span class="keyword">|</span> <span class="symbol">sex</span><span class="keyword">,</span> <span class="argument">spread</span><span class="argument">=</span><span class="number">TRUE</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">Davis</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">quantregLine</span><span class="keyword">)</span> <span class="comment">#  robust</span></div>
<p><img src='ScatterplotSmoothers-121.png' alt='' width='400' height='400' /></p>
<p><img src='ScatterplotSmoothers-122.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-129.png' alt='' width='400' height='400' /></p>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<strong class='message'>Loading required package: MatrixModels</strong>
<strong class='warning'>Warning message:
there is no package called ‘MatrixModels’</strong>
<p><img src='ScatterplotSmoothers-136.png' alt='' width='400' height='400' /></p>
<div class='input'><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/Random'>set.seed</a></span><span class="keyword">(</span><span class="number">12345</span><span class="keyword">)</span>
<span class="symbol">w</span> <span class="assignement">&lt;-</span> <span class="number">1</span> <span class="keyword">+</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/Poisson'>rpois</a></span><span class="keyword">(</span><span class="number">100</span><span class="keyword">,</span> <span class="number">5</span><span class="keyword">)</span>
<span class="symbol">x</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/Normal'>rnorm</a></span><span class="keyword">(</span><span class="number">100</span><span class="keyword">)</span>
<span class="symbol">p</span> <span class="assignement">&lt;-</span> <span class="number">1</span><span class="keyword">/</span><span class="keyword">(</span><span class="number">1</span> <span class="keyword">+</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/Log'>exp</a></span><span class="keyword">(</span><span class="keyword">-</span><span class="keyword">(</span><span class="symbol">x</span> <span class="keyword">+</span> <span class="number">0.5</span><span class="keyword">*</span><span class="symbol">x</span><span class="keyword">^</span><span class="number">2</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="symbol">s</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/Binomial'>rbinom</a></span><span class="keyword">(</span><span class="number">100</span><span class="keyword">,</span> <span class="symbol">w</span><span class="keyword">,</span> <span class="symbol">p</span><span class="keyword">)</span>
<span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">s</span><span class="keyword">/</span><span class="symbol">w</span> <span class="keyword">~</span> <span class="symbol">x</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">gamLine</span><span class="keyword">,</span>
       <span class="argument">smoother.args</span><span class="argument">=</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/list'>list</a></span><span class="keyword">(</span><span class="argument">family</span><span class="argument">=</span><span class="string">"binomial"</span><span class="keyword">,</span> <span class="argument">weights</span><span class="argument">=</span><span class="symbol">w</span><span class="keyword">)</span><span class="keyword">)</span></div>
<strong class='error'>Error in eval(expr, envir, enclos): object 'w' not found</strong>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">s</span><span class="keyword">/</span><span class="symbol">w</span> <span class="keyword">~</span> <span class="symbol">x</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">gamLine</span><span class="keyword">,</span>
       <span class="argument">smoother.args</span><span class="argument">=</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/list'>list</a></span><span class="keyword">(</span><span class="argument">family</span><span class="argument">=</span><span class="symbol">binomial</span><span class="keyword">,</span> <span class="argument">link</span><span class="argument">=</span><span class="string">"probit"</span><span class="keyword">,</span> <span class="argument">weights</span><span class="argument">=</span><span class="symbol">w</span><span class="keyword">)</span><span class="keyword">)</span></div>
<strong class='error'>Error in eval(expr, envir, enclos): object 'w' not found</strong>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">s</span><span class="keyword">/</span><span class="symbol">w</span> <span class="keyword">~</span> <span class="symbol">x</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">gamLine</span><span class="keyword">,</span>
       <span class="argument">smoother.args</span><span class="argument">=</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/list'>list</a></span><span class="keyword">(</span><span class="argument">family</span><span class="argument">=</span><span class="symbol">binomial</span><span class="keyword">,</span> <span class="argument">link</span><span class="argument">=</span><span class="string">"probit"</span><span class="keyword">,</span> <span class="argument">weights</span><span class="argument">=</span><span class="symbol">w</span><span class="keyword">)</span><span class="keyword">)</span></div>
<strong class='error'>Error in eval(expr, envir, enclos): object 'w' not found</strong>
<div class='input'><span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">s</span><span class="keyword">/</span><span class="symbol">w</span> <span class="keyword">~</span> <span class="symbol">x</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">loessLine</span><span class="keyword">,</span> <span class="argument">reg</span><span class="argument">=</span><span class="number">FALSE</span><span class="keyword">)</span></div>
<strong class='error'>Error in eval(expr, envir, enclos): object 'w' not found</strong>
<div class='input'>
<span class="symbol">y</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/Binomial'>rbinom</a></span><span class="keyword">(</span><span class="number">100</span><span class="keyword">,</span> <span class="number">1</span><span class="keyword">,</span> <span class="symbol">p</span><span class="keyword">)</span>
<span class="functioncall"><a href='scatterplot.html'>scatterplot</a></span><span class="keyword">(</span><span class="symbol">y</span> <span class="keyword">~</span> <span class="symbol">x</span><span class="keyword">,</span> <span class="argument">smoother</span><span class="argument">=</span><span class="symbol">gamLine</span><span class="keyword">,</span> <span class="argument">smoother.args</span><span class="argument">=</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/list'>list</a></span><span class="keyword">(</span><span class="argument">family</span><span class="argument">=</span><span class="symbol">binomial</span><span class="keyword">)</span><span class="keyword">)</span></div>
<strong class='error'>Error in eval(expr, envir, enclos): object 'y' not found</strong></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>ScatterplotSmoothers</li><li>gamLine</li><li>quantregLine</li><li>loessLine</li>
    </ul>
    <ul>
      <li>hplot</li>
    </ul> -->
      
    <h2>See also</h2>
    <code><a href='scatterplot.html'>scatterplot</a></code>, <code><a href='scatterplotMatrix.html'>scatterplotMatrix</a></code>, <code><a href='http://www.inside-r.org/r-doc/mgcv/gam'>gam</a></code>,
    <code><a href='http://www.inside-r.org/r-doc/stats/loess'>loess</a></code>, and <code><a href='http://www.inside-r.org/r-doc/quantreg/rqss'>rqss</a></code>.
    
    <h2>Author</h2>
    John Fox <a href='mailto:jfox@mcmaster.ca'>jfox@mcmaster.ca</a> and Sanford Weisberg<a href='mailto:sandy@umn.edu'>sandy@umn.edu</a>.
    
  </div>
</div>