      <h1> Case bootstrap for regression models </h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><span class="functioncall"><a href='bootCase.html'>bootCase</a></span><span class="keyword">(</span><span class="symbol">object</span><span class="keyword">,</span> <span class="argument">f</span> <span class="argument">=</span> <span class="symbol">coef</span><span class="keyword">,</span> <span class="argument">B</span> <span class="argument">=</span> <span class="number">999</span><span class="keyword">)</span>

<span class="functioncall"><a href='bootCase.html'>bootCase</a></span><span class="keyword">(</span><span class="symbol">object</span><span class="keyword">,</span> <span class="argument">f</span> <span class="argument">=</span> <span class="symbol">coef</span><span class="keyword">,</span> <span class="argument">B</span> <span class="argument">=</span> <span class="number">999</span><span class="keyword">)</span>

<span class="functioncall"><a href='bootCase.html'>bootCase</a></span><span class="keyword">(</span><span class="symbol">object</span><span class="keyword">,</span> <span class="argument">f</span> <span class="argument">=</span> <span class="symbol">coef</span><span class="keyword">,</span> <span class="argument">B</span> <span class="argument">=</span> <span class="number">999</span><span class="keyword">)</span>

<span class="functioncall"><a href='bootCase.html'>nextBoot</a></span><span class="keyword">(</span><span class="symbol">object</span><span class="keyword">,</span> <span class="symbol">sample</span><span class="keyword">)</span></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>object</dt>
      <dd> A regression object of type <code>lm</code>, <code>glm</code> or class
<code>nls</code>.  May work with other regression objects that support the <code>update</code>
method and has a <code>subset</code> argument.  See details below.</dd>
      <dt>f</dt>
      <dd>A function that will be applied to the updated regression object to
compute the statistics of interest.  The default is <code>coef</code>, to return to
regression coefficient estimates.</dd>
      <dt>B</dt>
      <dd>Number of bootstrap samples.</dd>
      <dt>sample</dt>
      <dd>A sample with replacement of the integers from 
1 to n=non-missing sample size that defines a bootstrap sample.</dd>
    </dl>
    
    <div class="Description">
      <h2>Description</h2>
      
      <p>This routine does a case bootstrap resampling for regression models.  It
returns a matrix of the estimated coefficients from each of the bootstrap
samples.</p>
  
    </div>

    <div class="Details">
      <h2>Details</h2>
      
      <p>This routine does the case-bootstrap described in the references below.  Begin
with a regression object.  For each of B bootstrap samples, sample the 
non-missing rows of the data
matrix with replacement, and recompute and save estimates.  For nls objects there may
be convergence problems in the bootstrap.  The routine will continue until
convergence is attained B times, or until there are 25 consecutive failures to converge. 
<code>nextBoot</code> is an internal function that will update a model correctly, depending
on the class of the model object.</p>
  
      <p>This simple routine should return a result with any S3 regression object that
can be updated using the <code>update</code> function and has a <code>subset</code>
argument.  It is OK in general for
linear regression, logistic regression in which the response is either zero or
one.  With bionomial responses, one would generally want to resample one
observation, not all the observations in m trials, so this function will
incorrect results.  The function can be used with Poisson regression with Poisson
sampling, but it is probably wrong for contingency tables with multinomial
sampling.  It is OK proportional odds models without Frequencies set, but
inappropriate with Frequencies.</p>
  
    </div>

    <div class="Value">
      <h2>Value</h2>
      
      <p>A matrix (with class <code>c("bootCase", "matrix")</code>) with B rows and rank(object)
columns giving the bootstrap estimates.
These can be summarized as needed using standard R tools.  The returned object
has an attribute <code>"pointEstimate"</code> that contains the value of the function
<code>f</code> applied to the argument <code>object</code>.</p>
  
    </div>

    <div class="References">
      <h2>References</h2>
      
      <p>Fox, J. and Weisberg, S. (2011) <em>Companion to Applied Regression</em>, Second Edition.
Thousand Oaks:  Sage.</p>
  
      <p>S. Weisberg (2005) <em>Applied Linear Regression</em>, Third Edition.   
Wiley, Chapters 4 and 11.</p>
  
    </div>

    <div class=" Case bootstrap for regression models ">
      <h2> Case bootstrap for regression models </h2>
      
    </div>

    <div class=" Case bootstrap for regression models ">
      <h2> Case bootstrap for regression models </h2>
      
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'><span class="symbol">m1</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/lm'>lm</a></span><span class="keyword">(</span><span class="symbol">Fertility</span> <span class="keyword">~</span> <span class="symbol">.</span><span class="keyword">,</span> <span class="symbol">swiss</span><span class="keyword">)</span>
<span class="symbol">betahat</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/coef'>coef</a></span><span class="keyword">(</span><span class="symbol">m1</span><span class="keyword">)</span>
<span class="symbol">betahat.boot</span> <span class="assignement">&lt;-</span> <span class="functioncall"><a href='bootCase.html'>bootCase</a></span><span class="keyword">(</span><span class="symbol">m1</span><span class="keyword">,</span><span class="argument">B</span><span class="argument">=</span><span class="number">99</span><span class="keyword">)</span> <span class="comment"># 99 bootstrap samples--too small to be useful</span>
<span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/summary'>summary</a></span><span class="keyword">(</span><span class="symbol">betahat.boot</span><span class="keyword">)</span>  <span class="comment"># default summary</span></div>
<div class='output'>  (Intercept)     Agriculture       Examination        Education          Catholic      Infant.Mortality
 Min.   : 40.6   Min.   :-0.3599   Min.   :-1.1061   Min.   :-1.3505   Min.   :0.0170   Min.   :-0.252  
 1st Qu.: 59.3   1st Qu.:-0.2316   1st Qu.:-0.5008   1st Qu.:-1.0424   1st Qu.:0.0750   1st Qu.: 0.887  
 Median : 66.3   Median :-0.1818   Median :-0.2672   Median :-0.8636   Median :0.1019   Median : 1.186  
 Mean   : 67.2   Mean   :-0.1866   Mean   :-0.3073   Mean   :-0.8347   Mean   :0.0991   Mean   : 1.137  
 3rd Qu.: 74.1   3rd Qu.:-0.1405   3rd Qu.:-0.0848   3rd Qu.:-0.7056   3rd Qu.:0.1231   3rd Qu.: 1.408  
 Max.   :109.3   Max.   :-0.0421   Max.   : 0.4752   Max.   : 0.0918   Max.   :0.1700   Max.   : 2.526  
</div>
<div class='input'><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/cbind'>cbind</a></span><span class="keyword">(</span><span class="string">"Bootstrap SD"</span><span class="argument">=</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/apply'>apply</a></span><span class="keyword">(</span><span class="symbol">betahat.boot</span><span class="keyword">,</span> <span class="number">2</span><span class="keyword">,</span> <span class="symbol">sd</span><span class="keyword">)</span><span class="keyword">,</span>
    <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/t'>t</a></span><span class="keyword">(</span><span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/apply'>apply</a></span><span class="keyword">(</span><span class="symbol">betahat.boot</span><span class="keyword">,</span> <span class="number">2</span><span class="keyword">,</span> <span class="keyword">function</span><span class="keyword">(</span><span class="formalargs">x</span><span class="keyword">)</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/stats/quantile'>quantile</a></span><span class="keyword">(</span><span class="symbol">x</span><span class="keyword">,</span> <span class="functioncall"><a href='http://www.inside-r.org/r-doc/base/c'>c</a></span><span class="keyword">(</span><span class="number">.025</span><span class="keyword">,</span> <span class="number">.975</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span><span class="keyword">)</span></div>
<div class='output'>                 Bootstrap SD     2.5%    97.5%
(Intercept)          12.02561 47.94029 94.18230
Agriculture           0.06422 -0.30891 -0.07537
Examination           0.31553 -0.98483  0.30917
Education             0.28038 -1.22836 -0.10323
Catholic              0.03608  0.02829  0.16662
Infant.Mortality      0.44417  0.20300  1.83085
</div></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>bootCase</li><li>bootCase.lm</li><li>bootCase.glm</li><li>bootCase.nls</li><li>nextBoot</li><li>nextBoot.lm</li><li>nextBoot.nls</li>
    </ul>
    <ul>
      <li>regression</li><li>internal</li>
    </ul> -->
      
    <h2>See also</h2>
    See Also  <code><a href='http://www.inside-r.org/r-doc/stats/update'>update</a></code>
    
    <h2>Author</h2>
     Sanford Weisberg, <a href='mailto:sandy@stat.umn.edu'>sandy@stat.umn.edu</a>.  The error checking was
written by
Lexin Li.
    
  </div>
</div>